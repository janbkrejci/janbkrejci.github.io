(this["webpackJsonpgun-react"]=this["webpackJsonpgun-react"]||[]).push([[0],{19:function(e,t,n){"use strict";n.r(t);var o,r=n(0),s=n.n(r),i=n(3),c=n.n(i),a=n(5),u=n(12),l=n(2),j=n(9),d=n.n(j),h=n(1),b=Object(u.a)((function(e){var t=Object(r.useState)(""),n=Object(a.a)(t,2),o=n[0],s=n[1],i=Object(r.useState)(""),c=Object(a.a)(i,2),u=c[0],j=c[1],b=Object(r.useState)(""),O=Object(a.a)(b,2),g=O[0],f=O[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h1",{children:"TODO"}),"U\u017eivatel ",e.store.user.alias,Object(h.jsx)("br",{}),e.store.error&&Object(h.jsx)("div",{style:{backgroundColor:"pink"},children:e.store.error}),Object(h.jsx)("br",{}),Object(h.jsx)("pre",{children:d.a.chain(Object(l.c)(e.store.todos)).orderBy((function(e){return e[1].created})).map((function(t){return Object(h.jsxs)("div",{children:["id: ",t[1].uid," / text: ",t[1].text," / created:"," ",t[1].created,"\xa0",Object(h.jsx)("button",{onClick:function(){e.store.deleteTodo(t[0])},children:"Smazat"})]},t[0])})).value()}),"New TODO:"," ",Object(h.jsx)("input",{value:g,onChange:function(e){f(e.target.value)}}),Object(h.jsx)("button",{onClick:function(){e.store.addTodo(g),f("")},children:"Add TODO"}),Object(h.jsx)("hr",{}),"Login:"," ",Object(h.jsx)("input",{value:o,onChange:function(e){s(e.target.value)}}),Object(h.jsx)("br",{}),"Password:"," ",Object(h.jsx)("input",{value:u,type:"password",onChange:function(e){j(e.target.value)}}),Object(h.jsx)("br",{}),Object(h.jsx)("button",{onClick:function(){e.store.login(o,u)},children:"Sign In"}),Object(h.jsx)("button",{onClick:function(){e.store.createUser(o,u)},children:"Sign Up"}),Object(h.jsx)("br",{}),Object(h.jsx)("button",{onClick:function(){e.store.logout()},children:"Logout"})]})})),O=n(4),g=n(7),f=n(10),p=n(11),v=n(21);Object(l.b)({enforceActions:"never",useProxies:"ifavailable"});var x,k=!0;function m(){k&&(console.log("(re)creating Gun connection"),k=!1,(x=Gun({peers:["https://ts.nas-system.cz/gun"],onConnect:m,onDisconnect:y,uuid:v.a})).on("auth",w),x.user().recall({sessionStorage:!0}),window.gun=x)}function y(){k=!0}function w(){o.mapPropertiesToGun()}var C=new(function(){function e(){Object(f.a)(this,e),this.user={alias:"nep\u0159ihl\xe1\u0161en"},this.error="",this.todos={},Object(l.e)(this),window.store=this,o=this,m()}return Object(p.a)(e,[{key:"mapPropertiesToGun",value:function(){var e=this;console.log("map props to gun"),this.user={alias:"p\u0159ihl\xe1\u0161en"},x.user().get("todos").map().on((function(t,n){e.todos=t?Object(g.a)(Object(g.a)({},e.todos),{},Object(O.a)({},n,t)):_.omit(e.todos,[n])}))}},{key:"cleanData",value:function(){x.user().get("todos").map().off(),this.todos={}}},{key:"isLoggedIn",value:function(){return x.user().is?(this.error="",!0):(this.setError("Nep\u0159ihl\xe1\u0161en\xfd u\u017eivatel"),!1)}},{key:"addTodo",value:function(e){if(this.isLoggedIn()){var t=Object(v.a)();x.user().get("todos").get(t).put({uid:t,text:e,created:(new Date).toISOString()})}}},{key:"deleteTodo",value:function(e){this.isLoggedIn()&&x.user().get("todos").get(e).put(null)}},{key:"setError",value:function(e){this.error=e;var t=this;setTimeout((function(){t.error=""}),3e3)}},{key:"createUser",value:function(e,t){var n=this;e?t?t.length<5?this.setError("Heslo mus\xed b\xfdt aspo\u0148 5 znak\u016f dlouh\xe9"):x.user().create(e,t,(function(e){console.log("xxx",e),e.err&&n.setError("U\u017eivatel ji\u017e existuje")})):this.setError("Nezadali jste heslo"):this.setError("Nezadali jste p\u0159ihla\u0161ovac\xed jm\xe9no")}},{key:"login",value:function(e,t){var n=this;x.user().auth(e,t,(function(e){e.err&&n.setError("Neplatn\xe9 p\u0159ihl\xe1\u0161en\xed")}))}},{key:"logout",value:function(){x.user().leave(),this.user={alias:"nep\u0159ihl\xe1\u0161en"},this.cleanData()}}]),e}());c.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(b,{store:C})}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.2bcb5a4b.chunk.js.map